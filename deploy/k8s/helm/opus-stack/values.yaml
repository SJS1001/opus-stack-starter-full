# Global configuration
global:
  imageRegistry: ghcr.io
  imageRepository: sjs1001/opus-stack-starter-full
  imagePullPolicy: IfNotPresent
  imageTag: "latest"

# Image pull secrets (if using private registry)
imagePullSecrets: []
# - name: ghcr-secret

# Service configurations
gateway:
  enabled: true
  replicaCount: 2
  image:
    repository: gateway
  service:
    type: LoadBalancer
    port: 80
    targetPort: 8080
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi
  env:
    - name: ASPNETCORE_ENVIRONMENT
      value: "Production"

customer:
  enabled: true
  replicaCount: 2
  image:
    repository: customer
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

telemetry:
  enabled: true
  replicaCount: 2
  image:
    repository: telemetry
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

workflow:
  enabled: true
  replicaCount: 2
  image:
    repository: workflow
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

files:
  enabled: true
  replicaCount: 2
  image:
    repository: files
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

# Infrastructure dependencies
ravendb:
  enabled: true
  replicaCount: 1
  image:
    repository: ravendb/ravendb
    tag: 6.0-ubuntu-latest
  service:
    type: ClusterIP
    port: 8080
  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""
  env:
    - name: RAVEN_Security_UnsecuredAccessAllowed
      value: "PrivateNetwork"
    - name: RAVEN_Setup_Mode
      value: "None"

timescaledb:
  enabled: true
  replicaCount: 1
  image:
    repository: timescale/timescaledb
    tag: 2.14.2-pg16
  service:
    type: ClusterIP
    port: 5432
  persistence:
    enabled: true
    size: 20Gi
    storageClass: ""
  env:
    - name: POSTGRES_PASSWORD
      value: "postgres"
    - name: POSTGRES_USER
      value: "postgres"
    - name: POSTGRES_DB
      value: "telemetry"

rabbitmq:
  enabled: true
  replicaCount: 1
  image:
    repository: rabbitmq
    tag: 3-management
  service:
    type: ClusterIP
    amqpPort: 5672
    managementPort: 15672
  persistence:
    enabled: true
    size: 5Gi
    storageClass: ""

mqtt:
  enabled: true
  replicaCount: 1
  image:
    repository: eclipse-mosquitto
    tag: "2"
  service:
    type: ClusterIP
    mqttPort: 1883
    wsPort: 9001

prometheus:
  enabled: true
  replicaCount: 1
  image:
    repository: prom/prometheus
    tag: latest
  service:
    type: ClusterIP
    port: 9090
  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""

grafana:
  enabled: true
  replicaCount: 1
  image:
    repository: grafana/grafana
    tag: latest
  service:
    type: LoadBalancer
    port: 3000
  persistence:
    enabled: true
    size: 5Gi
    storageClass: ""
  env:
    - name: GF_SECURITY_ADMIN_PASSWORD
      value: "admin"
    - name: GF_USERS_ALLOW_SIGN_UP
      value: "false"

# Configuration
config:
  jwt:
    issuer: "https://opus-gateway"
    audience: "opus-api"
    signingKey: "your-256-bit-secret-key-replace-in-production-min-32-chars"
    expirationMinutes: "60"
    enableValidation: "false"

  raven:
    urls: "http://opus-ravendb:8080"
    database: "opus"

  postgres:
    connectionString: "Host=opus-timescaledb;Username=postgres;Password=postgres;Database=telemetry;Pooling=true"

  mqtt:
    broker: "opus-mqtt"
    port: "1883"

  rabbitmq:
    uri: "amqp://guest:guest@opus-rabbitmq:5672/"
